'use strict';Object.defineProperty(exports,'__esModule',{value:!0});var _slicedToArray=function(){function a(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{!d&&h['return']&&h['return']()}finally{if(e)throw f}}return c}return function(b,c){if(Array.isArray(b))return b;if(Symbol.iterator in Object(b))return a(b,c);throw new TypeError('Invalid attempt to destructure non-iterable instance')}}(),_axios=require('axios'),_axios2=_interopRequireDefault(_axios),_Github=require('../Helpers/Github'),_Github2=_interopRequireDefault(_Github),_Trello=require('../Helpers/Trello'),_Trello2=_interopRequireDefault(_Trello),_Arrays=require('../Helpers/Arrays');function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _asyncToGenerator(a){return function(){var b=a.apply(this,arguments);return new Promise(function(a,c){function d(e,f){try{var g=b[e](f),h=g.value}catch(a){return void c(a)}return g.done?void a(h):Promise.resolve(h).then(function(a){d('next',a)},function(a){d('throw',a)})}return d('next')})}}require('dotenv').config();var trelloKey=process.env.TRELLO_KEY,trelloToken=process.env.TRELLO_TOKEN,auth='?key='+trelloKey+'&token='+trelloToken,gha={headers:{Authorization:'bearer '+process.env.GITHUB_TOKEN}};exports.default=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b){var c;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_axios2.default.all([_axios2.default.get('https://api.trello.com/1/boards/5b70b2c75105750d2795cccb/members'+auth),_axios2.default.get('https://api.trello.com/1/boards/5b70b2c75105750d2795cccb/cards'+auth),_axios2.default.get('https://api.trello.com/1/boards/5b70b2c75105750d2795cccb/lists'+auth),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=1',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=2',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=3',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=4',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=5',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=6',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/pulls?state=closed&page=7',gha),_axios2.default.get('https://api.github.com/repos/Lambda-School-Labs/CS9-LambdaLabsDashboard/contributors',gha)]);case 2:if(c=a.sent,!c){a.next=9;break}return a.next=6,parseData(c,b);case 6:return a.abrupt('return',a.sent);case 9:return a.abrupt('return',!1);case 10:case'end':return a.stop();}},a,void 0)}));return function(){return a.apply(this,arguments)}}();var handleError=function(){return!1},getValidUsers=function(a){return(0,_Arrays.arrayFilter)(a,function(a){var b=a.name,c=b.split(' '),d=_slicedToArray(c,2),e=d[0],f=d[1];if('null'!==b&&e&&f)return a})},parseData=function(){var a=_asyncToGenerator(regeneratorRuntime.mark(function a(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=_slicedToArray(b,11),e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=[].concat(_toConsumableArray(h.data),_toConsumableArray(i.data),_toConsumableArray(j.data),_toConsumableArray(k.data),_toConsumableArray(l.data),_toConsumableArray(m.data),_toConsumableArray(n.data)),a.next=4,(0,_Github2.default)(o.data,p,gha);case 4:return q=a.sent,r=new _Trello2.default(q,e.data,f.data,g.data),s=r.trello,t=r.completeness,u=r.updatedTeamStats,v=r.totalCards,w=r.inProgress,a.abrupt('return',{project:c,team:getValidUsers(u),trello:s,totalCards:v,inProgress:w,completeness:t});case 7:case'end':return a.stop();}},a,void 0)}));return function(){return a.apply(this,arguments)}}();